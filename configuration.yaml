homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret home_latitude
  longitude: !secret home_longitude
  # Impacts weather/sunrise data
  elevation: 0
  # Unit system
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Amsterdam

  customize_glob:
    "sensor.*_lux":
      device_class: light
    "sensor.*_humidity":
      device_class: moisture
      icon: mdi:water-percent
  customize: !include configuration/customize.yaml

# Enables the frontend
frontend:

lovelace:
  mode: yaml

system_health:

map:

zone:
  # This will override the default home zone
  - name: Home
    latitude: !secret home_latitude
    longitude: !secret home_longitude
    radius: 100
    icon: mdi:home

http:
  api_password: !secret api_password
  base_url: !secret base_url
  ip_ban_enabled: True
  login_attempts_threshold: 5

# Checks for available updates
updater:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:

# View all events in a logbook
logbook:

recorder:
  purge_interval: 2
  purge_keep_days: 8
  db_url: !secret db_url

# Track the sun
sun:

config:

# InfluxDB
influxdb:
  host: influxdb
  database: homeassistant
  default_measurement: state
  exclude:
    entities:
      - sensor.power_usage
      - switch.achtertuin_sensor_141
      - switch.gang_1ste_sensor_170
      - switch.gang_2de_sensor_159
      - switch.living_sensor_119
      - switch.rookmelder_1ste_22
      - switch.rookmelder_2de_133
      - switch.rookmelder_bg_3
      - switch.voordeur_200
      - switch.wasmachine_37
      - binary_sensor.ping_to_vera
      - sensor.ring_voordeur_battery
      - sensor.ring_voordeur_wifi_signal_strength
      - sensor.chantal_battery_level
      - sensor.chantal_battery_level_2
      - sensor.chantal_battery_state
      - sensor.chantal_battery_state_2
      - sensor.tim_living
      - sensor.netatmo_bedroom_battery_percent
      - sensor.netatmo_outdoor_battery_percent
  tags:
    source: hass

mqtt:
  broker: mosquitto
  port: 1883
  client_id: home-assistant
  keepalive: 60
  birth_message:
    topic: 'hass/status'
    payload: 'online'
    qos: 1
    retain: true
  will_message:
    topic: 'hass/status'
    payload: 'offline'
    qos: 1
    retain: true

sensor:
  - platform: yr
  - platform: ring
  - platform: rest
    resource: http://192.168.150.19/a?f=j
    value_template: '{{ value_json.pwr }}'
    method: GET
    name: Power usage
    unit_of_measurement: 'W'
  - platform: mqtt
    name: 'Shed Temperature'
    state_topic: homeassistant/sensor/shed_temperature/state
    unit_of_measurement: '°C'
  - platform: mqtt
    name: 'Shed Humidity'
    state_topic: homeassistant/sensor/shed_humidity/state
    unit_of_measurement: '%'
  - platform: mqtt
    state_topic: 'home/presence/owner/living/94:65:2d:d8:b6:3b'
    value_template: '{{ value_json.confidence }}'
    unit_of_measurement: '%'
    name: 'Tim living'
  - platform: template
    sensors:
      nefit_temperature:
        friendly_name: 'Nefit Temperature'
        value_template: '{{ states.climate.heating.attributes.current_temperature }}'
        unit_of_measurement: '°C'
  - platform: mqtt
    name: plant_1_moisture
    state_topic: home/plants/plant1/
    value_template: '{{ value_json.moisture }}'
    device_class: humidity
    unit_of_measurement: '%'
  - platform: mqtt
    name: plant_1_battery
    state_topic: home/plants/plant1/
    value_template: '{{ value_json.battery }}'
    device_class: battery
    unit_of_measurement: '%'
  - platform: mqtt
    name: plant_1_temperature
    state_topic: home/plants/plant1/
    value_template: '{{ value_json.temperature }}'
    device_class: temperature
    unit_of_measurement: '°C'
  - platform: mqtt
    name: plant_1_conductivity
    state_topic: home/plants/plant1/
    value_template: '{{ value_json.conductivity }}'
    unit_of_measurement: 'μS/cm'
  - platform: mqtt
    name: plant_1_brightness
    state_topic: home/plants/plant1/
    value_template: '{{ value_json.brightness }}'
    device_class: illuminance
    unit_of_measurement: 'lux'
  - platform: mqtt
    name: plant_2_moisture
    state_topic: home/plants/plant2/
    value_template: '{{ value_json.moisture }}'
    device_class: humidity
    unit_of_measurement: '%'
  - platform: mqtt
    name: plant_2_battery
    state_topic: home/plants/plant2/
    value_template: '{{ value_json.battery }}'
    device_class: battery
    unit_of_measurement: '%'
  - platform: mqtt
    name: plant_2_temperature
    state_topic: home/plants/plant2/
    value_template: '{{ value_json.temperature }}'
    device_class: temperature
    unit_of_measurement: '°C'
  - platform: mqtt
    name: plant_2_conductivity
    state_topic: home/plants/plant2/
    value_template: '{{ value_json.conductivity }}'
    unit_of_measurement: 'μS/cm'
  - platform: mqtt
    name: plant_2_brightness
    state_topic: home/plants/plant2/
    value_template: '{{ value_json.brightness }}'
    device_class: illuminance
    unit_of_measurement: 'lux'

plant:
  hangplant:
    sensors:
      moisture: sensor.plant_1_moisture
      battery: sensor.plant_1_battery
      temperature: sensor.plant_1_temperature
      conductivity: sensor.plant_1_conductivity
      brightness: sensor.plant_1_brightness
    min_moisture: 15
    min_battery: 15
  hoekplant:
    sensors:
      moisture: sensor.plant_2_moisture
      battery: sensor.plant_2_battery
      temperature: sensor.plant_2_temperature
      conductivity: sensor.plant_2_conductivity
      brightness: sensor.plant_2_brightness
    min_moisture: 15
    min_battery: 15

vera:
  vera_controller_url: http://192.168.150.10:3480/
  lights: [5, 7, 31, 6, 44, 132, 148, 32, 152, 208, 245]
  exclude: [197, 198, 199, 149, 150, 30, 146, 147, 213]

netatmo:
  api_key: !secret netatmo_api_key
  secret_key: !secret netatmo_secret_key
  username: !secret netatmo_username
  password: !secret netatmo_password

ring:
  username: !secret ring_username
  password: !secret ring_password

shell_command:
  vera_home_mode: 'curl -k "http://192.168.150.10:3480/data_request?id=lu_action&serviceId=urn:micasaverde-com:serviceId:HomeAutomationGateway1&action=RunScene&SceneNum=6"'
  vera_away_mode: 'curl -k "http://192.168.150.10:3480/data_request?id=lu_action&serviceId=urn:micasaverde-com:serviceId:HomeAutomationGateway1&action=RunScene&SceneNum=16"'
  privacy_mode_enable: !secret cmd_privacy_mode_enable
  privacy_mode_disable: !secret cmd_privacy_mode_disable

binary_sensor:
  - platform: template
    sensors:
      wasmachine_state:
        friendly_name: 'Wasmachine'
        value_template: >
          {% if states.switch.wasmachine_37 %}
            {{ states.switch.wasmachine_37.attributes.current_power_w > 2 }}
          {% endif %}
  - platform: mqtt
    name: 'Shed sensor'
    state_topic: homeassistant/binary_sensor/shed_motion/state
    device_class: motion
  - platform: ping
    host: 192.168.150.10
    name: Ping to Vera
  - platform: ring

input_boolean:
  night_mode:
    name: Slaapstand
    icon: mdi:sleep
  ghost_mode:
    name: Ghostmode
    icon: mdi:ghost
  notify_backyard_motion:
    name: Notify on backyard motion
    icon: mdi:access-point
  automatic_vacuum_cleaner:
    name: Run the vacuum cleaner at night
    icon: mdi:robot

media_player:
  - platform: braviatv
    host: 192.168.150.192

sonos:
  media_player:
    hosts:
      - 192.168.150.141
      - 192.168.150.197

cast:
  media_player:
    - host: 192.168.150.124
    - host: 192.168.150.153

tts:
  - platform: google
    language: nl
    cache: true
    cache_dir: /tmp/tts
    time_memory: 300

notify:
  - name: all
    platform: group
    services:
      - service: telegram_notify
  - name: telegram_notify
    platform: telegram
    chat_id: !secret telegram_chat_id

device_tracker:
  - platform: asuswrt
    host: 192.168.150.1
    username: !secret router_user
    password: !secret router_password
    consider_home: 0:10
    new_device_defaults:
      track_new_devices: false

telegram_bot:
  platform: polling
  api_key: !secret telegram_api_key
  allowed_chat_ids:
    - !secret telegram_chat_id

alarm_control_panel:
  platform: manual
  name: Home Alarm
  pending_time: 0
  trigger_time: 1 # Workaround to prevent being in the triggered state

vacuum:
  - platform: xiaomi_miio
    host: 192.168.150.162
    token: !secret xiaomi_token

climate:
  platform: nefit
  name: Heating
  serial: !secret nefit_serial
  accesskey: !secret nefit_accesskey
  password: !secret nefit_password

ios:

asuswrt:
  host: 192.168.150.1
  username: !secret router_user
  password: !secret router_password

google_assistant:
  project_id: !secret google_assistant_project_id
  expose_by_default: false
  entity_config:
    climate.heating:
      name: Verwarming
      room: Huis
      expose: true
    input_boolean.night_mode:
      name: Slaapstand
      room: Huis
      expose: true
    switch.ventilatie_145:
      name: Ventilatie
      room: Huis
      expose: true
    light.woonkamer_spots_5:
      name: Woonkamer licht
      room: Woonkamer
      expose: true
    light.keuken_spots_7:
      name: Keuken licht
      room: Keuken
      expose: true
    light.buitenlicht_achter_6:
      name: Achtertuin licht
      room: Achtertuin
      expose: true
    light.buitenlicht_voorkant_32:
      name: Voortuin licht
      room: Voortuin
      expose: true
    light.gang_licht_31:
      name: Gang licht
      room: Gang
      expose: true
    light.licht_tuindeur_148:
      name: Tuindeur licht
      room: Achtertuin
      expose: true
    light.light_babyroom_208:
      name: Babykamer licht
      room: Babykamer
      expose: true
    light.overloop_licht_1ste_44:
      name: Overloop eerste licht
      room: Overloop eerste verdieping
      expose: true
    light.overloop_licht_2de_132:
      name: Overloop tweede licht
      room: Overloop tweede verdieping
      expose: true
    light.werkkamer_licht_152:
      name: Werkkamer licht
      room: Werkkamer
      expose: true
    scene.living_movie:
      name: Movie night scene
      room: Woonkamer
      expose: true
    scene.living_normal:
      name: Woonkamer normaal scene
      room: Woonkamer
      expose: true

automation: !include_dir_merge_list configuration/automation/
script: !include_dir_named configuration/script/

scene: !include configuration/scene.yaml
camera: !include configuration/camera.yaml
